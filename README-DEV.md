# CRM Development Server

Node.js сервер для удобной разработки CRM проекта с поддержкой PHP, live reload и статических файлов.

## 🚀 Быстрый старт

### 1. Установка зависимостей
```bash
npm install
```

### 2. Запуск сервера
```bash
npm start
```

Сервер будет доступен по адресу: **http://localhost:3000**

## ⚙️ Возможности

- **🔄 PHP Proxy** - автоматическая проксификация PHP запросов к XAMPP/WAMP
- **🔥 Live Reload** - автоматическая перезагрузка при изменении файлов
- **📁 Статические файлы** - обслуживание CSS, JS, изображений
- **🛠️ Настройки** - гибкая конфигурация через `dev-config.js`

## 📋 Требования

1. **Node.js** (версия 14+)
2. **PHP сервер** (XAMPP, WAMP, MAMP) запущенный на порту 80

## 🔧 Настройка

### Изменение порта PHP сервера

Если ваш PHP сервер работает не на порту 80, отредактируйте `dev-config.js`:

```javascript
module.exports = {
  phpServerUrl: 'http://localhost:8080', // ваш порт
  // ...
};
```

### Настройка файлов для отслеживания

В `dev-config.js` можно настроить, какие файлы отслеживать:

```javascript
watchPaths: [
  '**/*.php',
  '**/*.js', 
  '**/*.css',
  '**/*.html'
]
```

## 📝 Команды

| Команда | Описание |
|---------|----------|
| `npm start` | Запуск production сервера |
| `npm run dev` | Запуск с nodemon (автоперезапуск) |
| `npm install` | Установка зависимостей |

## 🐛 Решение проблем

### PHP сервер не отвечает
```
❌ PHP Proxy Error: connect ECONNREFUSED
```

**Решение:**
1. Убедитесь, что запущен XAMPP/WAMP
2. Проверьте порт в `dev-config.js`
3. Попробуйте открыть `http://localhost:80` в браузере

### Live reload не работает
1. Проверьте консоль браузера на ошибки WebSocket
2. Убедитесь, что порт 3000 не занят другим приложением

### Файлы не обновляются
1. Проверьте, что файлы находятся в `watchPaths`
2. Убедитесь, что файлы не в `ignorePaths`

## 🔍 Логи

Сервер выводит подробные логи:
- `🔄 Proxying: GET /index.php` - проксирование PHP
- `📝 File changed: js/app.js` - изменение файла
- `🔌 Client connected` - подключение live reload

## 🏗️ Архитектура

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Браузер       │───▶│  Node.js Server │───▶│   PHP Server    │
│ localhost:3000  │    │   (Express)     │    │  localhost:80   │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         ▲                       │
         │                       ▼
         └─────── WebSocket ──────┘
              (Live Reload)
```

## 📦 Зависимости

- **express** - веб-сервер
- **http-proxy-middleware** - проксирование PHP
- **chokidar** - отслеживание файлов
- **ws** - WebSocket для live reload
- **cors** - CORS поддержка

## 🎯 Workflow

1. Запускаете `npm start`
2. Открываете `http://localhost:3000`
3. Редактируете PHP/JS/CSS файлы
4. Страница автоматически перезагружается
5. PHP запросы проксируются к XAMPP/WAMP

Удачной разработки! 🚀 